<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Hello SBOM - Lamm Consulting AB</title>
<meta name="description" content="Going down the rabbithole of SBOM:s">
<meta name="generator" content="Hugo 0.92.2" />
<link href="https://lammda.se//index.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://lammda.se/sample/custom-shortcodes/">
<link rel="stylesheet" href="https://lammda.se/css/theme.min.css">
<link rel="stylesheet" href="https://lammda.se/css/chroma.min.css">
<script defer src="https://lammda.se//js/fontawesome6/all.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js" integrity="sha256-H3cjtrm/ztDeuhCN9I4yh4iN2Ybx/y1RM7rMmAesA0k=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js" integrity="sha256-4XodgW4TwIJuDtf+v6vDJ39FVxI0veC/kSCCmnFp7ck=" crossorigin="anonymous"></script>
<script src="https://lammda.se/js/bundle.js"></script><style>
:root {}
</style>
<meta property="og:title" content="Hello SBOM" />
<meta property="og:description" content="Going down the rabbithole of SBOM:s" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lammda.se/sample/custom-shortcodes/" /><meta property="og:image" content="https://lammda.se/images/og-image.png"/><meta property="article:section" content="sample" />
<meta property="article:published_time" content="2017-10-17T15:26:15+00:00" />
<meta property="article:modified_time" content="2017-10-17T15:26:15+00:00" /><meta property="og:site_name" content="Hugo Techdoc Theme" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://lammda.se/images/og-image.png"/>

<meta name="twitter:title" content="Hello SBOM"/>
<meta name="twitter:description" content="Going down the rabbithole of SBOM:s"/>
<meta itemprop="name" content="Hello SBOM">
<meta itemprop="description" content="Going down the rabbithole of SBOM:s"><meta itemprop="datePublished" content="2017-10-17T15:26:15+00:00" />
<meta itemprop="dateModified" content="2017-10-17T15:26:15+00:00" />
<meta itemprop="wordCount" content="1007"><meta itemprop="image" content="https://lammda.se/images/og-image.png"/>
<meta itemprop="keywords" content="" /></head>
<body><div class="container"><header>
<h1>Lamm Consulting AB</h1>
<p class="description">Nybrogatan 34 114 39 Stockholm</p>

</header>
<div class="global-menu">
<nav>
<ul>
<li id="home" class=""><a href="/">Home</a></li>
<li class=""><a href="/post/goisforlovers/">Offering</a></li><li class="parent "><a href="">Partners<i class="fas fa-angle-right"></i></a>
<ul class="sub-menu">
<li class="child "><a href="/post/creating-a-new-theme/">Sidiatech</a></li>
<li class="child "><a href="/post/migrate-from-jekyll/">T2Data</a></li>
</ul>
</li>
<li class=""><a href="/post/hugoisforlovers/">Sustainability</a></li></ul>
</nav>
</div>

<div class="content-container">
<main><h1>Hello SBOM</h1>
<aside class="table_of_contents">
<h5>Table of Contents</h5><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a>
      <ul>
        <li><a href="#hello-sbom-world">Hello SBOM World</a></li>
      </ul>
    </li>
    <li><a href="#toolchain">Toolchain</a>
      <ul>
        <li><a href="#preprocessor">Preprocessor</a></li>
        <li><a href="#compile">Compile</a>
          <ul>
            <li><a href="#optimize">Optimize</a></li>
          </ul>
        </li>
        <li><a href="#linking">Linking</a>
          <ul>
            <li><a href="#static--linking">Static  linking</a></li>
            <li><a href="#dynamic-linking">Dynamic linking</a></li>
            <li><a href="#legal-issues">Legal issues</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#cybersecurity-resilience-act">Cybersecurity Resilience Act</a>
      <ul>
        <li><a href="#article-10">Article 10</a></li>
      </ul>
    </li>
    <li><a href="#assumptions">Assumptions</a>
      <ul>
        <li><a href="#firmware">Firmware</a></li>
        <li><a href="#hardware">Hardware</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a>
      <ul>
        <li><a href="#trust">Trust</a></li>
        <li><a href="#trust-1">Trust</a></li>
      </ul>
    </li>
  </ul>
</nav></aside>

<h2 id="introduction">Introduction</h2>
<p>The process of building software could be compared with a factory assembly line where the product is on
on top of the belt and the toolchain is the assemly line itself.</p>
<p>Let&rsquo;s make it easy by keeping the product to four-line of source code, so we can focus on the underlying assembly line ( toolchain and platform ).</p>
<p>Hello world is the most famous C program , but in the era of <a href="https://cyclonedx.org/guides/sbom/introduction/">Software-bill-of-material</a> it raises several challenges.</p>
<ul>
<li>Include directives</li>
<li>The C compiler</li>
<li>C library</li>
<li>Linux Kernel</li>
</ul>
<h3 id="hello-sbom-world">Hello SBOM World</h3>
<p>This is the product</p>
<pre tabindex="0"><code class="language-code" data-lang="code">#include &lt;stdio.h&gt;
int main(void) 
{ 
 printf(&quot;Hello sbom\n&quot;); 
}
</code></pre><p>Hello World by itself is not an application that handles user data or performs complex tasks,
so there are usually no security concerns associated with it. &ldquo;Chat-GPT&rdquo;</p>
<p>In AI we trust so let&rsquo;s assume that Hello SBOM is bug-free. Next step is the generation of a binary, for that we need a toolchain.</p>
<h2 id="toolchain">Toolchain</h2>
<p>The <a href="https://gcc.gnu.org">GCC compiler</a> is the most important part of the assembly line, it is also a very complex software and and therefore vulnerabilities exists  <a href="https://www.cvedetails.com/vulnerability-list/vendor_id-72/product_id-960/GNU-GCC.html">security issues</a>. Most distributions like Ubuntu, Redhat, Debian etc provides their own compiler, but you can also build you own group up with <a href="https://github.com/hans-lammda/crosstool-ng">Crosstool-NG</a></p>
<p>Building software with GCC actives several steps.</p>
<table>
<thead>
<tr>
<th>Step</th>
<th>Option</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Preprocessing</td>
<td>-E</td>
<td>#include &lt;stdio.h&gt; will be replaced with the content of /usr/include/stdio.h</td>
</tr>
<tr>
<td>Generate Assembly</td>
<td>-S</td>
<td>Output a textfile with assemly code interleaved with commented C code</td>
</tr>
<tr>
<td>Optimize</td>
<td>-O</td>
<td>Optimize execution time and size for the final binary</td>
</tr>
<tr>
<td>Staticly linked</td>
<td>&ndash;static</td>
<td>Binary interfaces directly with kernel</td>
</tr>
</tbody>
</table>
<h3 id="preprocessor">Preprocessor</h3>
<p>The preprocessor is basically a text processor with the capability of including other files. There is also simple programming support with variables and conditions</p>
<pre tabindex="0"><code class="language-code" data-lang="code">gcc -std=c89  -E -o bom.txt sbom.c
</code></pre><p>Depending of which of the C language being used, different files being included.</p>
<pre tabindex="0"><code class="language-code" data-lang="code">gcc -std=c99  -E -o bom99.txt sbom.c
</code></pre><p><a href="bom.txt">Preprocesser output</a></p>
<p><a href="bom_cpp_diff.txt">Difference C89 and C99</a></p>
<h3 id="compile">Compile</h3>
<p>Compile source code into binary</p>
<pre tabindex="0"><code class="language-code" data-lang="code">gcc  sbom.c -lc -o sbom
</code></pre><h4 id="optimize">Optimize</h4>
<p>However, there are gazillions of different parameters to control how to generate a binary. Two frequent flags are optimization (-Olevel ) and (-S) for generating human-readable assembly code. The latter is very important to ensure that private data and keys are handled correctly.</p>
<pre tabindex="0"><code class="language-code" data-lang="code">gcc -O2 -S -o bom.s bom.c
gcc -O2 -S -o bom.ss bom.c
diff bom.s bom.ss &gt; bom.s.diff.txt
</code></pre><p><a href="bom.s.txt">Assembler output</a></p>
<p><a href="bom.s.diff.txt">Difference when optimization is applied</a></p>
<h3 id="linking">Linking</h3>
<h4 id="static--linking">Static  linking</h4>
<pre tabindex="0"><code class="language-code" data-lang="code">gcc  sbom.c -lc -static -o sbom
</code></pre><h4 id="dynamic-linking">Dynamic linking</h4>
<pre tabindex="0"><code class="language-code" data-lang="code">gcc  sbom.c -lc -o sbom
</code></pre><table>
<thead>
<tr>
<th>Type of linking</th>
<th>size of binary ( bytes )</th>
</tr>
</thead>
<tbody>
<tr>
<td>Static</td>
<td>900344</td>
</tr>
<tr>
<td>Dynamic</td>
<td>15960</td>
</tr>
</tbody>
</table>
<p>executing the dynamicly linked binary. With strace the calls to C-library could be traced</p>
<pre tabindex="0"><code class="language-code" data-lang="code">strace ./sbom

openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libc.so.6&quot;, O_RDONLY|O_CLOEXEC) = 3

Hello sbom

</code></pre><h4 id="legal-issues">Legal issues</h4>
<p>C library is the interface to the Linux kernel and comes in many many <a href="https://www.etalabs.net/compare_libcs.html">flavors</a>.</p>
<table>
<thead>
<tr>
<th>Library</th>
<th>License</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.gnu.org/software/libc">Gnu libc</a></td>
<td><a href="https://en.wikipedia.org/wiki/GNU_Lesser_General_Public_Licens">LGPL</a> 2.1+ w/exceptions</td>
</tr>
<tr>
<td><a href="https://wiki.musl-libc.org">Muslc</a></td>
<td><a href="https://en.wikipedia.org/wiki/MIT_License">MIT</a></td>
</tr>
<tr>
<td><a href="https://gitlab.redox-os.org/redox-os/relibc">Relibc</a></td>
<td><a href="https://en.wikipedia.org/wiki/MIT_License">MIT</a></td>
</tr>
</tbody>
</table>
<p>There might be security issues with the C library such as <a href="https://ubuntu.com/security/CVE-2019-1010022">CVE-2019-1010022</a></p>
<p><em>GNU Libc current is affected by: Mitigation bypass. The impact is: Attacker may bypass stack guard protection. The component is: nptl. The attack vector is: Exploit stack buffer overflow vulnerability and use this bypass vulnerability to bypass stack guard. NOTE: Upstream comments indicate “this is being treated as a non-security bug and no real threat.”</em></p>
<p>The kernel contains 30+ millions lines of code and and have also <a href="https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html">security issues</a></p>
<h2 id="cybersecurity-resilience-act">Cybersecurity Resilience Act</h2>
<p>The underlying C library and Linux kernel provides a <strong>software platform</strong> so we better check <a href="https://digital-strategy.ec.europa.eu/en/library/cyber-resilience-act">CRA and article 10</a></p>
<h3 id="article-10">Article 10</h3>
<p><em>In order not to hamper innovation or research, free and open-source software
developed or supplied outside the course of a commercial activity should not be
covered by this Regulation. This is in particular the case for software, including its
source code and modified versions, that is openly shared and freely accessible, usable,
modifiable and redistributable. In the context of software, a commercial activity might
be characterized not only by charging a price for a product, but also by charging a
price for technical support services, by providing a <strong>software platform</strong> through which
the manufacturer monetises other services, or by the use of personal data for reasons
other than exclusively for improving the security, compatibility or interoperability of
the software.</em></p>
<h2 id="assumptions">Assumptions</h2>
<p>In addition to what we can download and build from internet, there are still layers that is hard to verify and must be trusted.</p>
<h3 id="firmware">Firmware</h3>
<p><a href="https://t2data.com/project/haspoc/">T2data</a> was engaged in a research project together with <a href="https://www.ericsson.com/en/blog/2017/8/high-assurance-virtualization-for-armv8">Ericsson</a></p>
<p>We contributed by writing a simple bootloader from scratch inspired by two projects:</p>
<ul>
<li><a href="https://www.trustedfirmware.org/">Arm Trusted Firmware</a></li>
<li><a href="https://www.denx.de/project/u-boot/">Uboot</a> <a href="https://www.youtube.com/watch?v=YlJBsVZJkDI">Uboot</a></li>
</ul>
<p>The project was originally designed for the <a href="https://community.arm.com/oss-platforms/w/docs/485/juno">Juno development board</a> and includes the very first instruction residing in <a href="https://raw.githubusercontent.com/hans-lammda/secure_boot/main/open_src/src/bios_low/arm64_v8_dev-1.1/bl1/aarch64/bl1_entrypoint.S">ROM</a>.</p>
<p>To keep track of headerfiles being used we selected  <a href="https://subversion.apache.org/">Subversion</a> since it support keywords</p>
<p>All header files used in the project contains a preprocessor variable assigned a value from subversion</p>
<p><em>bignum.h</em></p>
<pre tabindex="0"><code class="language-code" data-lang="code">#define BIGNUM_H_DEF &quot;$HeadURL: $ $Revision: $&quot;

</code></pre><p>In the implementation that includes the header file a static variable get the value assigned to the header macro.
All keywords is allocated to a section .keywords that is removed furing the final step in the build process.</p>
<p><em>bignum.c</em></p>
<pre tabindex="0"><code class="language-code" data-lang="code">#include &quot;bignum.h&quot;
char secure_bios_bignum_header[]  __attribute__ ((section (&quot;.keywords&quot;)))  = BIGNUM_H_DEF;
</code></pre><p>Each compiled artifact could then be backtracked to source by executing the ident command line utility.</p>
<pre tabindex="0"><code class="language-code" data-lang="code">$ ident bignum.o

 bignum.o:
    $HeadURL: https://cm-ext.dev.oniteo.com/svn/nanodev/packages/secure_bios/branches/haspoc/hikey/secure_bios/pki/bignum.c $
    $Revision: 26005 $
    $HeadURL: https://cm-ext.dev.oniteo.com/svn/nanodev/packages/secure_bios/branches/haspoc/hikey/secure_bios/pki/bignum.h $
    $Revision: 17411 $
</code></pre><p>Keeping the keywords in a dedicated section make it easy to keep or drop the information in different instances of the build pipelines.</p>
<p>KEEP(*(.keywords))</p>
<h3 id="hardware">Hardware</h3>
<ul>
<li><a href="https://developer.arm.com/documentation/ddi0602/2023-09/Base-Instructions/CSINC--Conditional-Select-Increment-?lang=en">Hardware</a> Architecture is all about the instruction set for a developer</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Even if the product on top of the assembly line is very small and without bugs, the assembly line itself is very complex. The overall security depends on both the product and the tool.
The tool also includes the platform, C-library, and Linux kernel, in addition, we assume that firmware and hardware are trusted.</p>
<h3 id="trust">Trust</h3>
<p>In 1984 Ken Thompson wrote the paper <a href="https://www.cs.cmu.edu/~rdriley/487/papers/Thompson_1984_ReflectionsonTrustingTrust.pdf">Reflections on trusting Trust</a>, that address how to trust the output from a very simple program being compiled.</p>
<h3 id="trust-1">Trust</h3>
<p><a href="https://www.youtube.com/watch?v=YlJBsVZJkDI">Uboot</a></p>
<div class="edit-meta"><br></div><nav class="pagination"><a class="nav nav-prev" href="https://lammda.se/sample/" title="Software Supply Chain"><i class="fas fa-arrow-left" aria-hidden="true"></i>&nbsp;Prev - Software Supply Chain</a>
<a class="nav nav-next" href="https://lammda.se/sample/markdown-syntax/" title="Serving static content">Next - Serving static content <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer></footer>
</main>
<div class="sidebar">

<nav class="slide-menu">
<ul>
<li class=""><a href="https://lammda.se/">Home</a></li>



<li class="parent has-sub-menu"><a href="https://lammda.se/sample/">Software Supply Chain<span class="mark opened">-</span></a>
  
<ul class="sub-menu">
<li class="active"><a href="https://lammda.se/sample/custom-shortcodes/">Hello SBOM</a></li>
<li class=""><a href="https://lammda.se/sample/markdown-syntax/">Serving static content</a></li>
</ul>
  
</li>














</ul>
</nav>



<div class="sidebar-footer"></div>
</div>

</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
